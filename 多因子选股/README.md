# Quant

# Fama-French三因子模型

&emsp;&emsp;Fama和French 1992年对美国股票市场决定不同股票回报率差异的因素的研究发现，**股票的市场的beta值**不能解释不同股票回报率的差异，而**上市公司的市值**、**账面市值比**、**市盈率可以解释股票回报率的差异**。Fama and French 认为，*上述超额收益是对CAPM 中β未能反映的风险因素的补偿*。

**股票的市场的beta值**：

&emsp;&emsp;*股票β值表示投资组合对系统风险的敏感程度*:β值为1，表示指数变化时，股票价格会以相同的百分率变化;β值为1.8时，表示指数发生1%的变动，股票价格会呈现1.8%的变动;β值为值0.5时，表示指数发生1%的变动，股票价格会呈现0.5%的变动。

&emsp;&emsp;*行情上涨时，一般选取β值偏高的投资组合;行情下跌时，一般选取β值偏低的投资组合，这样才能取得最佳收益。*

&emsp;&emsp;当然，β值是历史数据的统计，有一定的时效性，这一点在应用时必须考虑。


**市值**：

&emsp;&emsp;是指一家上市公司的发行股份按市场价格计算出来的股票总价值，其计算方法为每股股票的市场价格乘以发行总股数。
&emsp;&emsp;整个股市上所有上市公司的市值总和，即为股票总市值。

**账面市值比**：

&emsp;&emsp;BM效应（BM Effect）或称B/M效应、账面市值比效应(book—to—market efect)

&emsp;&emsp;所谓BM效应，指账面市值比效应，*指BM值较高的公司平均月收益率高于BM值较低的公司*。

&emsp;&emsp;关于BM效应，国内外学者已做了许多研究。Fama和French（1992）研究了1963到1990年所有在NYSE、AMEX、NASDAQ上市的股票，发现BM值最高的组合（价值组合）月均收益率超过BM值最低的组合（魅力组合）达1.53%。

&emsp;&emsp;肖军，徐信忠（2004）以1993年6月至2001年6月沪深股市A股股票为样本，计算持有一年、两年、三年的收益率数据，认为BM效应存在。

**市盈率**：

&emsp;&emsp;市盈率（Price Earnings Ratio，简称P/E或PER），也称“本益比”、“股价收益比率”或“市价盈利比率（简称市盈率）”。

&emsp;&emsp;*市盈率是指股票价格除以每股收益(每股收益,EPS)的比率。*

&emsp;&emsp;或以公司市值除以年度股东应占溢利。市盈率是某种股票每股市价与每股盈利的比率。*市场广泛谈及市盈率通常指的是静态市盈率，通常用来作为比较不同价格的股票是否被高估或者低估的指标。*

&emsp;&emsp;*市盈率是最常用来评估股价水平是否合理的指标之一*，是很具参考价值的股市指针，一方面，投资者亦往往不认为严格按照会计准则计算得出的盈利数字真实反映公司在持续经营基础上的获利能力，因此，分析师往往自行对公司正式公布的净利加以调整。

# 表达式
&emsp;&emsp;模型认为，一个投资组合(包括单个股票)的超额回报率可由它对三个因子的暴露来解释，**这三个因子是：市场风险溢酬因子(Rm− Rf)、市值因子(SMB)、账面市值比因子(HML)。**

&emsp;&emsp;市场风险溢酬因子对应了市场投资组合的收益率，市值因子对应了做多市值较小的公司与做空市值较大的公司的投资组合带来的收益率，账面市值比因子对应的是做多高BM公司、做空低BM公司的投资组合带来的收益率。

&emsp;&emsp;这个多因子均衡定价模型可以表示为：

$$
E\left(R_{i t}\right)-R_{f t}=b_{i}\left[E\left(R_{m t}\right)-R_{f t}\right]+s_{i} E\left(S M B_{t}\right)+h_{i} E\left(H M L_{t}\right)
$$

&emsp;&emsp;其中Rft表示时间t的无风险收益率；Rmt表示时间t的市场收益率；Rit表示资产i在时间t的收益率；

&emsp;&emsp;E(Rmt) − Rft是市场风险溢价，SMBt为时间t的市值(Size)因子的模拟组合收益率(Small minus Big)，HMLt为时间t的账面市值比(book—to—market)因子的模拟组合收益率(High minus Low)。

&emsp;&emsp;**β、si和hi分别是三个因子的系数**

# 回归模型
回归模型表示如下：

$$
R_{i t}-R_{f t}=\alpha_{i}+b_{i}\left(R_{m t}-R_{f t}\right)+s_{i} S M B_{t}+h_{i} H M L_{t}
$$

&emsp;&emsp;$Rit$:我们要研究的投资组合或个股的收益率序列

&emsp;&emsp;$Rft$ :无风险收益率，比如国债的收益率序列

&emsp;&emsp;$ai$:超额收益率，是投资组合或个股在大盘波动带来的收益之外的额外收益率

&emsp;&emsp;$Rmt$:市场投资组合收益率序列，常用合适的大盘指数来替代

&emsp;&emsp;$SMBt$:市值投资组合收益率序列

&emsp;&emsp;$HMLt$:BM投资组合收益率序列

&emsp;&emsp;$εit$:误差项

&emsp;&emsp;这样大家就比较熟悉了，一个常数项，三个自变量，一个误差项，一个因变量，妥妥的一个多元线性回归模型。跟CAPM中一样，α代表超额收益率，越高越好，说明我们的投资组合越优秀。

&emsp;&emsp;不要看到这么多名词就害怕，在实际应用过程中，这些数据都是已知的，我们直接把数据扔给计算机，通过最小二乘法求解得到α、b、s、h的估计值即可以及它们是否显著即可。

&emsp;&emsp;唯一稍显麻烦一点的是SMB和HML的计算，这一部分需要先根据流通市值将股票分为1：1的大市值（B）和小市值（S)股票；根据BM数据将股票分为3：4：3的高中低（H/M/L）三组；这样我们就有了2×3共计6种投资组合（SL/SM/SH/BL/BM/BH）。然后我们通过市值加权平均的方式求得各组的收益率，最后就是求SMB和HML了：
$$
\begin{gathered}
S M B_{t}=\frac{1}{3}\left(S L_{t}+S M_{t}+S H_{t}\right)-\frac{1}{3}\left(B L_{t}+B M_{t}+B H t\right) \\
H M L_{t}=\frac{1}{2}\left(S H_{t}+B H_{t}\right)-\frac{1}{2}\left(S L_{t}+B L_{t}\right)
\end{gathered}
$$
